<HTML>
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=213 -->
                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<link rel="stylesheet" href="style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>213. Strong Defence
</h4></div><div align=center>time limit per test: 2
 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>The Chief of the Galactic Empire has recently received some bad news from his spies. The Dark Lord is preparing to attack the Empire. His fleet of spaceships is ready for the first hyperjump.
<br>
<br>It is well known that travelling in space is very simple. You just start from some star and make a series of hyperjumps to other stars. You can only jump from one star to another if they are connected with a special hyperjump tunnel, which is bidirectional, thus allowing to make a jump from one star that it connects to another. Of course, the tunnels are designed in such a way that there is the way to get from each star to any other one.
<br>
<br>However, there is the way to block the hyperjump &mdash; to do this one must put a special battleship in the corresponding hypertunnel.
<br>
<br>Of course, the Chief would like to block all hyperpaths from the star where the headquaters of the Dark Lord are located to  the star where the capital of the Galactic Empire is. The resources of the Empire are almost unbounded, so it is easy to create as many battleships as needed. Unfortunately, there is one problem.
<br>
<br>Each hyperjump blocking battleship must have a special crystal on board which allows him to stay in the hyperspace. There is a number of types of such crystals. The problem is that there is the way  to destroy all battleships carrying some particular type of crystal.
<br>
<br>Although it is known, that for each crystal type there is the way to destroy  battleships powered by this crystal, there is hope that not all of  those are known to Dark Lord engineers. So the Chief would like to use blocking ships in such a way that the following conditions are satisfied:
<br><ul>
<br>    <li> for each crystal type, if all ships with other crystal types         are destroyed, battle ships with this crystal type block         hypertunnels in such a way, that there is no path from Dark Lord's         star to Empire Capital star;
<br>    <li> the number of different crystal types used in ships is maximal        possible;
<br>    <li> no two ships block the same hypertunnel.
<br></ul>
<br>You may consider that there is the unlimited number of crystal types available and crystals of each type available.
<br>
</div><div align = left><br><b>Input</b></div><div align = left>
<br>The first line of the input file contains N &mdash; the number of stars in the Galaxy(2 &le; N &le; 400), M -- the number of tunnels, S and T &mdash; numbers of stars where Dark Lord headquaters and Empire Capital are located respectively (S &ne; T). 
<br>
<br>Next M lines contain two integer numbers each &mdash; the numbers of the stars the corresponding tunnel connects. No tunnel connects a star to itself, no two stars are connected with more than one tunnel.
<br>
<br>
</div><div align = left><br><b>Output</b></div><div align = left>
<br>First output L &mdash; the number of crystal types used. After that output L lines, for each crystal type output first K<sub>i</sub> &mdash; the number of battleships with this crystal used, and then K<sub>i</sub> numbers,  identifying the hypertunnels blocked by the corresponding battleship. The tunnels are numbered starting from 1, as they are given in the input file.
<br>
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>4 4 1 4
<br>1 2
<br>1 3
<br>2 4
<br>3 4
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>2
<br>2  1 2
<br>2  3 4
<br>
</div><div align = left></pre></div><div align = left></font></div><div align = left><div align = right> <a href = 'submit.php@problem=213'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'forum.php@contest=0&problem=213'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew Stankevich
</td></tr><tr><td>Resource:</td><td>Petrozavodsk Summer Trainings 2003
</td></tr><tr><td>Date:</td><td>2003-08-30
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2008-09-03 15:40:54</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2008. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body></html> 
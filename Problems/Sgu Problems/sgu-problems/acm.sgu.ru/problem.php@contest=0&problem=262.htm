<HTML>
<!-- saved from url=(0051)http://acm.sgu.ru/problem.php?contest=0&problem=262 -->
                               <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Saratov State University :: Online Contester</title>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META NAME="keywords" CONTENT="???">
<META NAME="description" CONTENT="???">
<link rel="stylesheet" href="style-1024.css" type="text/css">
</head>      <body bgcolor=#F3F6F9 style = 'font-size : 9pt;' text=#000000 link=#336699 vlink=#336699 alink=#336699><div align="center">
    <div align=center><h4>262. Symbol Recognition
</h4></div><div align=center>time limit per test: 1
 sec.<br>memory limit per test: 65536
 KB</div><div align=center>input: standard<br>output: standard</div><br><br><br><div align = left>Consider a monochrome computer monitor with N x M pixels resolution. It can display K symbols. Symbol is a non-empty set of black pixels on the screen. You are to write a program, that computes minimal possible amount of pixels, that are enough to recognize a symbol.
</div><div align = left><br><b>Input</b></div><div align = left>First line of input contains integers N, M, K (1 &lt;= N, M &lt;= 10, 2 &lt;= K &lt;= 6). K blocks follow, separated by empty lines. Each block consists of N rows of M characters. It's a symbols representation on the N x M screen. `1' denotes black pixel, `0' denotes white pixel. You may assume that symbols are unique.
</div><div align = left><br><b>Output</b></div><div align = left>Print on the first line of output the minimal possible amount of pixels that enough to recognize symbol. I.e. you have to find set of pixels that has different color in each pair of symbols. If there are several sets with equal amount of pixels, output any of them. Then print N lines M characters each. `1' denotes that corresponding pixel is in your set. `0' denotes that corresponding pixel is not in your set.
</div><div align = left><br><b>Sample test(s)</b></div><div align = left><br>Input</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>2 4 3
<br>0000
<br>0001
<br>
<br>1000
<br>0001
<br>
<br>1111
<br>1001
</div><div align = left></pre></div><div align = left></font></div><div align = left><br>Output</div><div align = left><font face='Courier New'></div><div align = left><pre></div><div align = left>2
<br>1000
<br>1000
</div><div align = left></pre></div><div align = left></font></div><div align = left><br><b>Note</b></div><div align = left>In this example output set consists of two most left pixels. They are both white in first symbol; black and white in second symbol; both black in third symbol. So, it's possible to recognize each symbol using this set of pixels. 
</div><div align = left><div align = right> <a href = 'submit.php@problem=262'>[submit]</a> </div></div><div align = left><div align = right> <a href = 'forum.php@contest=0&problem=262'>[forum]</a> </div></div><div align = left><hr></div><table align=left cellspacing=7><tr><td>Author:</td><td>Andrew V. Lazarev
</td></tr><tr><td>Resource:</td><td>Saratov SU Contest: Golden Fall 2004
</td></tr><tr><td>Date:</td><td>October 2, 2004
</td></tr></table><br><br><br><br><br><br><br><br><br><br><br><table width=100% class=tb cellpadding=0 cellspacing=0><tr><td><table width=100% cellspacing=1 ><tr><td bgcolor=#FFFFFF> <table width=100% cellpadding=0 cellspacing=0 border=0><tr style='background-color : #FFFFFF;'><td align=left>Server time: 2008-09-03 15:41:19</td><td align=right><a target=_top href='mailto:acm@sgu.ru'>Online Contester</a> Team &copy; 2002 - 2008. All rights reserved.</td></tr></table></td></tr></table></td></tr></table></div></body></html> 